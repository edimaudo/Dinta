<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dinta â€” Strategic Decision Intelligence</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>

<body class="bg-gray-50 text-gray-900 min-h-screen">

<header class="bg-white border-b">
    <div class="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
        <h1 class="text-xl font-bold text-[#006adb]">Dinta</h1>
        <a href="/" class="text-sm text-gray-600 hover:underline">Home</a>
    </div>
</header>

<main class="max-w-4xl mx-auto px-6 py-12">

    <h2 class="text-3xl font-extrabold mb-8">
        Strategic Decision Intelligence
    </h2>

    <!-- Problem -->
    <div class="mb-6">
        <label class="block font-semibold mb-2">Problem Statement</label>
        <textarea id="problem"
            class="w-full border rounded-md p-4 h-32"
            placeholder="Describe the problem you want to solve..."></textarea>
    </div>

    <!-- Assumptions -->
    <div class="mb-6">
        <label class="block font-semibold mb-2">Assumptions (optional)</label>
        <textarea id="assumptions"
            class="w-full border rounded-md p-4 h-24"
            placeholder="List any assumptions..."></textarea>
    </div>

    <!-- Framework -->
    <div class="mb-6">
        <label class="block font-semibold mb-2">Framework</label>
        <select id="framework" class="border rounded-md p-2">
            <option value="auto">Let Dinta choose</option>
            <option value="SWOT">SWOT</option>
            <option value="FIRST_PRINCIPLES">First Principles</option>
            <option value="COST_BENEFIT">Cost Benefit</option>
        </select>
    </div>

    <button onclick="runAnalysis()"
        class="bg-[#006adb] text-white px-6 py-3 rounded-md font-semibold">
        Run Analysis
    </button>

    <!-- Loading -->
    <div id="loading" class="hidden mt-6 text-[#006adb] font-semibold">
        Analyzing with IBM watsonx Orchestrate...
    </div>

    <!-- Results -->
    <div id="results" class="mt-10 space-y-8"></div>

</main>

<script>
async function runAnalysis() {
    const resultsDiv = document.getElementById('results');
    const loadingDiv = document.getElementById('loading');

    resultsDiv.innerHTML = "";
    loadingDiv.classList.remove('hidden');

    const response = await fetch('/analyze', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            problem: document.getElementById('problem').value,
            assumptions: document.getElementById('assumptions').value,
            framework: document.getElementById('framework').value
        })
    });

    const data = await response.json();
    loadingDiv.classList.add('hidden');

    renderResults(data);
}

function renderResults(data) {
    const resultsDiv = document.getElementById('results');

    if (data.error) {
        resultsDiv.innerHTML = `<div class="text-red-600">${data.error}</div>`;
        return;
    }

    resultsDiv.innerHTML = `
        <div>
            <h3 class="text-xl font-bold mb-2">Structured Problem</h3>
            <pre class="bg-white border p-4 rounded-md">${JSON.stringify(data.structured_problem, null, 2)}</pre>
        </div>

        <div>
            <h3 class="text-xl font-bold mb-2">Selected Framework</h3>
            <pre class="bg-white border p-4 rounded-md">${JSON.stringify(data.selected_framework, null, 2)}</pre>
        </div>

        <div>
            <h3 class="text-xl font-bold mb-2">Framework Analysis</h3>
            <pre class="bg-white border p-4 rounded-md">${JSON.stringify(data.framework_output, null, 2)}</pre>
        </div>

        <div>
            <h3 class="text-xl font-bold mb-2">Solution</h3>
            <pre class="bg-white border p-4 rounded-md">${JSON.stringify(data.solution, null, 2)}</pre>
        </div>

        <div>
            <h3 class="text-xl font-bold mb-2">Execution Plan</h3>
            <pre class="bg-white border p-4 rounded-md">${JSON.stringify(data.execution_plan, null, 2)}</pre>
        </div>
    `;
}
</script>

</body>
</html>
